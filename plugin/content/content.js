!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultStorage=void 0,n(r(7),t),n(r(8),t),n(r(10),t),t.defaultStorage={isInitialized:!0,isSearching:!1,refreshRate:250,isLoggedIn:!0,trucks:[],logs:[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopsCountFilter=void 0;t.StopsCountFilter=class{filter(e,t){return e.forEach(e=>{(t||e.loads).forEach(t=>{t.stopCount<=2&&e.loads.push(t)})}),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(new(r(3).App)).init()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const i=r(4),n=r(6),s=r(11);class o extends n.AbstractApp{async init(){await this.storageService.initialize(),this.storageService.addListener(()=>this.startSearching(),"isSearching",!0),this.storageService.addListener(()=>this.stopSearching(),"isSearching",!1),this.storageService.addListener(async()=>{const e=await this.logsService.getLogs();console.log(e)},"logs")}async startSearching(){const e=await this.storageService.get("trucks");if(!e.length)return console.log("Trucks Length: ",e.length),await this.logsService.addLog({type:s.LogTypes.WARN,text:"Cannot start the search because no trucks found!"}),void await this.storageService.set("isSearching",!1);const t=await this.storageService.get("refreshRate");await this.logsService.addLog({type:s.LogTypes.INFO,text:"Starting the search with refresh rate: "+t+" And trucks: "+e.map(e=>e.name).join(", ")}),this.interval=setInterval(async()=>{const t=await i.getLoads();await this.logsService.addLog({type:s.LogTypes.INFO,text:"Relay responded with "+t.workOpportunities.length+" loads"});const r=await this.filtersService.collectCandidates(t.workOpportunities,e);console.log(r)},t)}stopSearching(){clearInterval(this.interval)}startTesting(){setTimeout(()=>{this.storageService.set("isSearching",!0).then(()=>{setTimeout(()=>{this.storageService.set("isSearching",!1)},2e3)})},4e3)}}t.App=o},function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLoads=void 0,t.getLoads=function(){return new Promise((e,t)=>{var r=new XMLHttpRequest;r.open("GET","https://relay.amazon.com/api/tours/loadboard"+function(e){return"?"+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")}({sortByField:"startTime",sortOrder:"asc",resultSize:200,minPricePerDistance:2.2,minPayout:1900}),!0),r.setRequestHeader("Content-Type","application/json"),r.withCredentials=!0;try{r.send(),r.onreadystatechange=()=>{r.readyState===XMLHttpRequest.DONE&&e(JSON.parse(r.response))}}catch(e){t(e)}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractApp=void 0;const i=r(0);t.AbstractApp=class{constructor(){this.interval=0,this.storageService=new i.StorageService,this.filtersService=new i.FiltersService,this.logsService=new i.LogsService(this.storageService)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageService=void 0;const i=r(0);t.StorageService=class{constructor(){this.nameSpace="local"}get(e){return new Promise((t,r)=>{try{chrome.storage[this.nameSpace].get([""+e],r=>{t(r[""+e])})}catch(e){r(e)}})}set(e,t){return new Promise((r,i)=>{try{chrome.storage[this.nameSpace].set({[""+e]:t},()=>r(!0))}catch(e){i(e)}})}addListener(e,t,r){chrome.storage.onChanged.addListener((i,n)=>{!i[""+t]||r&&r!==i[""+t].newValue||n!==this.nameSpace||e(i[""+t])})}initialize(){return new Promise((e,t)=>{try{this.get("isInitialized").then(r=>{r?e(!0):Promise.all(Object.entries(i.defaultStorage).map(([e,t])=>this.set(""+e,t))).then(r=>{r.every(Boolean)?e(!0):t("Some values in storage are not set successfully!")})})}catch(e){t(e)}})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FiltersService=void 0;const i=r(9);t.FiltersService=class{async collectCandidates(e,t){let r=t.map(e=>({truck:e,loads:[]}));return new Promise(t=>{const n=i.allFilters.shift();r=n?n.filter(r,e):r,i.allFilters.forEach(e=>{r=e.filter(r)}),t(r)})}}},function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.allFilters=void 0;const s=r(1);n(r(1),t),t.allFilters=[new s.StopsCountFilter]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogsService=void 0;t.LogsService=class{constructor(e){this.storageService=e}async addLog(e){const t=await this.getShiftedLogs();return t.push(e),this.storageService.set("logs",t)}getLogs(){return this.storageService.get("logs")}async getShiftedLogs(){const e=await this.storageService.get("logs");return e.length>29&&e.shift(),e}}},function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(12),t),n(r(16),t)},function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(13),t),n(r(14),t),n(r(15),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTypes=void 0,function(e){e[e.INFO=0]="INFO",e[e.WARN=1]="WARN",e[e.ERROR=2]="ERROR"}(t.LogTypes||(t.LogTypes={}))},function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(17),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}]);